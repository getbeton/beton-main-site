---
import Head from '../components/seo/Head.astro';
import GTMNoscript from '../components/analytics/GTMNoscript.astro';
import DataLayerEvents from '../components/analytics/DataLayerEvents.astro';
import CookieConsent from '../components/global/CookieConsent.astro';
import '../styles/global.css';
import '../styles/prose.css';

interface Props {
  title?: string;
  description?: string;
  ogImage?: string;
  canonicalPath?: string;
  noIndex?: boolean;
  type?: 'website' | 'article';
  schemaType?: string;
  faqData?: { question: string; answer: string }[];
  breadcrumbs?: { name: string; url: string }[];
  reviewData?: { name: string; role?: string; company?: string; quote: string }[];
  personData?: { name: string; role: string; bio?: string; social?: { twitter?: string; linkedin?: string; github?: string } }[];
}

const { title, description, ogImage, canonicalPath, noIndex, type, schemaType, faqData, breadcrumbs, reviewData, personData } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <Head
      title={title}
      description={description}
      ogImage={ogImage}
      canonicalPath={canonicalPath}
      noIndex={noIndex}
      type={type}
      schemaType={schemaType}
      faqData={faqData}
      breadcrumbs={breadcrumbs}
      reviewData={reviewData}
      personData={personData}
    />
  </head>
  <body class="min-h-screen flex flex-col overflow-x-hidden">
    <GTMNoscript />

    <!-- Theme initialization (prevents flash) -->
    <script is:inline>
      (function () {
        try {
          var t = localStorage.getItem('theme');
          if (t === 'dark' || t === 'light') {
            document.documentElement.setAttribute('data-theme', t);
          } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-theme', 'dark');
          }
        } catch (e) {}
      })();
    </script>

    <slot />

    <CookieConsent />
    <DataLayerEvents />
  </body>
</html>
