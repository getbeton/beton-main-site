---
import Container from '../ui/Container.astro';
import Section from '../ui/Section.astro';
import Heading from '../ui/Heading.astro';

const steps = [
  {
    number: '1',
    title: 'Connect PostHog',
    description:
      'Link your Posthog instance. Beton\'s agent learns your data model and website to focus on the important parts.',
    iconType: 'posthog',
  },
  {
    number: '2',
    title: 'Detect Signals',
    description:
      'Beton automatically discovers behavioral patterns that indicate buying intent, expansion, or churn risk.',
    iconType: 'path',
    icon: 'M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z',
  },
  {
    number: '3',
    title: 'Build Your Pipeline',
    description:
      'Signals are automatically routed to Attio, HubSpot, Zoho, Pipedrive, webhooks, or n8n for timely action.',
    iconType: 'path',
    icon: 'M7.5 21L3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5',
  },
  {
    number: '4',
    title: 'Improve Targeting Quality',
    description:
      'Connect more data sources like billing or support. Add AI enrichment of your customers. Custom ML models.',
    iconType: 'path',
    icon: 'M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75',
  },
];
---

<Section id="how-it-works" class="bg-[var(--color-surface-raised)] border-y-2 border-[var(--color-border)]">
  <Container>
    <div class="text-center mb-10 lg:mb-14">
      <Heading as="h2">How It Works</Heading>
      <p class="mt-4 text-lg text-[var(--color-text-secondary)] max-w-2xl mx-auto">
        Four steps from product data to revenue action.
      </p>
    </div>

    <!-- Vertical flow for mobile -->
    <div class="flex flex-col items-center md:hidden">
      {steps.map((step, i) => (
        <>
          <div class="flex items-start gap-5 w-full max-w-sm">
            <div class="flex flex-col items-center shrink-0">
              <div class="flex items-center justify-center w-14 h-14 border-2 border-[var(--color-primary-600)] bg-[var(--color-primary-bg)] text-[var(--color-primary-600)]">
                {step.iconType === 'posthog' ? (
                  <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9.854 14.5 5 9.647.854 5.5A.5.5 0 0 0 0 5.854V8.44a.5.5 0 0 0 .146.353L5 13.647l.147.146L9.854 18.5l.146.147v-.049c.065.03.134.049.207.049h2.586a.5.5 0 0 0 .353-.854L9.854 14.5zm0-5-4-4a.487.487 0 0 0-.409-.144.515.515 0 0 0-.356.21.493.493 0 0 0-.089.288V8.44a.5.5 0 0 0 .147.353l9 9a.5.5 0 0 0 .853-.354v-2.585a.5.5 0 0 0-.146-.354l-5-5zm1-4a.5.5 0 0 0-.854.354V8.44a.5.5 0 0 0 .147.353l4 4a.5.5 0 0 0 .853-.354V9.854a.5.5 0 0 0-.146-.354l-4-4zm12.647 11.515a3.863 3.863 0 0 1-2.232-1.1l-4.708-4.707a.5.5 0 0 0-.854.354v6.585a.5.5 0 0 0 .5.5H23.5a.5.5 0 0 0 .5-.5v-.6c0-.276-.225-.497-.499-.532zm-5.394.032a.8.8 0 1 1 0-1.6.8.8 0 0 1 0 1.6zM.854 15.5a.5.5 0 0 0-.854.354v2.293a.5.5 0 0 0 .5.5h2.293c.222 0 .39-.135.462-.309a.493.493 0 0 0-.109-.545L.854 15.501zM5 14.647.854 10.5a.5.5 0 0 0-.854.353v2.586a.5.5 0 0 0 .146.353L4.854 18.5l.146.147h2.793a.5.5 0 0 0 .353-.854L5 14.647z"></path>
                  </svg>
                ) : (
                  <svg class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d={step.icon}></path>
                  </svg>
                )}
              </div>
            </div>
            <div class="pt-1">
              <div class="text-xs font-mono font-semibold text-[var(--color-primary-500)] mb-1">Step {step.number}</div>
              <h3 class="text-lg font-bold font-[family-name:var(--font-heading)] mb-1.5">{step.title}</h3>
              <p class="text-[var(--color-text-secondary)] text-sm leading-relaxed">{step.description}</p>
            </div>
          </div>
          {i < steps.length - 1 && (
            <div class="flex items-center justify-start w-full max-w-sm pl-6 my-1">
              <svg class="w-2 h-8 text-[var(--color-primary-600)] opacity-40" viewBox="0 0 8 32" fill="none">
                <path d="M4 0v24M1 21l3 5 3-5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </div>
          )}
        </>
      ))}
    </div>

    <!-- Horizontal grid for tablet/desktop -->
    <div class="hidden md:grid md:grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12">
      {steps.map((step) => (
        <div class="text-center relative">
          <div class="absolute top-0 left-1/2 -translate-x-1/2 text-6xl font-[family-name:var(--font-heading)] text-[var(--color-text)] opacity-[0.06] select-none pointer-events-none" aria-hidden="true">{step.number}</div>
          <div class="inline-flex items-center justify-center w-16 h-16 border-2 border-[var(--color-primary-600)] bg-[var(--color-primary-bg)] text-[var(--color-primary-600)] mb-5 relative">
            {step.iconType === 'posthog' ? (
              <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.854 14.5 5 9.647.854 5.5A.5.5 0 0 0 0 5.854V8.44a.5.5 0 0 0 .146.353L5 13.647l.147.146L9.854 18.5l.146.147v-.049c.065.03.134.049.207.049h2.586a.5.5 0 0 0 .353-.854L9.854 14.5zm0-5-4-4a.487.487 0 0 0-.409-.144.515.515 0 0 0-.356.21.493.493 0 0 0-.089.288V8.44a.5.5 0 0 0 .147.353l9 9a.5.5 0 0 0 .853-.354v-2.585a.5.5 0 0 0-.146-.354l-5-5zm1-4a.5.5 0 0 0-.854.354V8.44a.5.5 0 0 0 .147.353l4 4a.5.5 0 0 0 .853-.354V9.854a.5.5 0 0 0-.146-.354l-4-4zm12.647 11.515a3.863 3.863 0 0 1-2.232-1.1l-4.708-4.707a.5.5 0 0 0-.854.354v6.585a.5.5 0 0 0 .5.5H23.5a.5.5 0 0 0 .5-.5v-.6c0-.276-.225-.497-.499-.532zm-5.394.032a.8.8 0 1 1 0-1.6.8.8 0 0 1 0 1.6zM.854 15.5a.5.5 0 0 0-.854.354v2.293a.5.5 0 0 0 .5.5h2.293c.222 0 .39-.135.462-.309a.493.493 0 0 0-.109-.545L.854 15.501zM5 14.647.854 10.5a.5.5 0 0 0-.854.353v2.586a.5.5 0 0 0 .146.353L4.854 18.5l.146.147h2.793a.5.5 0 0 0 .353-.854L5 14.647z"></path>
              </svg>
            ) : (
              <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d={step.icon}></path>
              </svg>
            )}
          </div>
          <div class="text-sm font-mono font-semibold text-[var(--color-primary-500)] mb-2">Step {step.number}</div>
          <h3 class="text-xl font-bold font-[family-name:var(--font-heading)] mb-3">{step.title}</h3>
          <p class="text-[var(--color-text-secondary)] text-base leading-relaxed">{step.description}</p>
        </div>
      ))}
    </div>
  </Container>
</Section>
